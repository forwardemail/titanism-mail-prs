/**
 * Base Styles & Reset
 * ====================
 * Global resets, box-sizing, and foundational HTML/body styles
 */

* {
  box-sizing: border-box;
}

html {
  height: 100%;
  margin: 0;
  padding: 0;
}

body {
  height: 100%;
  margin: 0 !important;
  padding: 0 !important;
  font-family: var(--font-sans);
  background:
    radial-gradient(circle at 20% 20%, rgba(0, 175, 248, 0.1) 0, transparent 25%),
    radial-gradient(circle at 80% 0%, rgba(0, 42, 144, 0.18) 0, transparent 30%), #02060f;
  color: var(--color-text);
  overflow-x: hidden;
  overflow-y: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body.mailbox-mode {
  overflow: hidden;
}

#mailbox-root {
  height: 100%;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

#profile-root,
#contacts-root,
#calendar-root {
  height: 100%;
  overflow-y: auto;
}

#rl-app {
  position: relative;
  width: 100%;
  height: 100%;
  display: block;
  visibility: hidden;
}

#rl-app.ready {
  visibility: visible;
}

/* Body has id=rl-app; use self-selector for login-centered layout */
body:not(.mailbox-mode)#rl-app {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

/* Login shell needs full width for proper centering */
.fe-login-shell {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}

#login-root {
  width: 100%;
}

/* Starfield background */
.fe-stars {
  position: fixed;
  inset: 0;
  overflow: hidden;
  z-index: -1;
  pointer-events: none;
}

/* Keep stars visible on login page even in light mode */
body:not(.mailbox-mode) .fe-stars {
  display: block;
}

/* Hide stars in mailbox mode (they would be distracting) */
body.mailbox-mode .fe-stars {
  display: none;
}

/* Light mode body styles */
body.light-mode {
  background:
    radial-gradient(circle at 20% 20%, rgba(0, 175, 248, 0.08) 0, transparent 25%),
    radial-gradient(circle at 80% 0%, rgba(0, 42, 144, 0.12) 0, transparent 30%), #f5f7fb;
  color: #0f172a;
  --color-bg: #ffffff;
  --color-panel: #ffffff;
  --color-bg-secondary: #f3f4f6;
  --color-border: #e2e8f0;
  --color-text: #0f172a;
  --color-muted: #1f2937;
  --color-accent: #2563eb;
  --color-accent-strong: #16a34a;
  --color-surface-strong: #0f172a;
  --color-surface: #f9fafb;
  --color-border-light: #e5e7eb;
  --color-text-secondary: #5f6368;
  --color-error: #dc2626;
  --color-success: #16a34a;
}

body.light-mode:not(.mailbox-mode) {
  /* Keep the galaxy vibe even in light mode */
  background:
    radial-gradient(circle at 20% 20%, rgba(0, 175, 248, 0.08) 0, transparent 25%),
    radial-gradient(circle at 80% 0%, rgba(0, 42, 144, 0.14) 0, transparent 30%), #02060f;
  color: var(--color-text);
}

/* Mobile keyboard handling */
@supports (padding: env(safe-area-inset-bottom)) {
  body {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .fe-compose-modal,
  .fe-reader,
  .fe-message-list {
    padding-bottom: calc(16px + env(safe-area-inset-bottom));
  }
}

/* Ensure inputs don't trigger zoom on iOS */
@media (max-width: 640px) {
  input[type='text'],
  input[type='email'],
  input[type='search'],
  textarea,
  select {
    font-size: 16px !important;
  }

  /* Smooth keyboard transitions */
  body {
    transition: height 0.3s ease;
  }

  /* Prevent body scroll when keyboard is open */
  body.keyboard-open {
    position: fixed;
    width: 100%;
  }
}

/* Visual Viewport API support for keyboard handling */
@supports (height: 100dvh) {
  @media (max-width: 640px) {
    #mailbox-root,
    #settings-root,
    #profile-root,
    #contacts-root,
    #calendar-root {
      height: 100dvh;
    }
  }
}

/* ============================================
   MOBILE TYPOGRAPHY SCALING
   Increase font sizes for better readability on mobile
   ============================================ */
@media (max-width: 640px) {
  /* Scale up base font sizes on mobile for readability */
  :root {
    --text-2xs: 11px;
    --text-xs: 12px;
    --text-sm: 13px;
    --text-base: 14px;
    --text-md: 15px;
    --text-lg: 16px;
    --text-xl: 18px;
    --text-2xl: 20px;
    --text-3xl: 22px;
  }

  /* Ensure body text is at least 14px for readability */
  body {
    font-size: 14px;
    line-height: 1.5;
  }

  /* Message content should be comfortable to read */
  .fe-message-subject {
    font-size: 15px;
  }

  .fe-message-from,
  .fe-message-snippet,
  .fe-message-date {
    font-size: 13px;
  }

  /* Folder list items */
  .fe-folder {
    font-size: 15px;
  }
}

/* ============================================
   ACCESSIBILITY: FOCUS INDICATORS
   Ensure visible focus states on mobile for keyboard navigation
   ============================================ */
@media (max-width: 640px) {
  /* Enhanced focus indicators for touch devices using keyboard */
  button:focus-visible,
  a:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible,
  [tabindex]:focus-visible {
    outline: 2px solid var(--color-primary, #00aff8);
    outline-offset: 2px;
  }

  /* Allow opt-out for inputs inside styled containers (e.g., recipient fields) */
  input.outline-none:focus-visible,
  textarea.outline-none:focus-visible {
    outline: none;
  }
}
